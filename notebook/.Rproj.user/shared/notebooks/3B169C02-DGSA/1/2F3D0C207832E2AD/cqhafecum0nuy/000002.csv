"0","datadir <- '../work/heterog_1000/MC_expt_2020-02-01-18-15/export_1000'"
"0",""
"0",""
"0",""
"0","# section_name = '501_1000' #confined"
"0","# section_name = '0_500' #unconfined"
"0","# test_var = 'AEM'"
"0","# test_var = 'conc'"
"0",""
"0","for (section_name in c('0_500','501_1000')){"
"0","  for (test_var in c('conc','AEM')){"
"0","    for (tim_ind in c(1,2,3,4)){"
"0","      INPUT    <- read.csv(file.path(datadir,sprintf(""ParametersValues_%s_%s_%d.csv"",test_var,section_name,tim_ind)))"
"0","      OUTPUT.D <- read.csv(file.path(datadir,sprintf(""D_%s_%s_%d.csv"",test_var,section_name,tim_ind)),header=FALSE)"
"0","      clustering <-read.csv(file.path(datadir,sprintf(""Cluster_%s_%s_%d.csv"",test_var,section_name,tim_ind)),header=FALSE)$V1"
"0","      "
"0","      cat(sprintf('Testing on %s, iterations %s, time ind %d\n\n(key: 0-500=unconfined;501-1000=confined)\n ',test_var,section_name,tim_ind))"
"0","      "
"0","      "
"0","      #Do DGSA"
"0","      myDGSA <- dgsa(clustering, INPUT, .interactions = TRUE, .nBoot = 100, .nBins = 3, .alpha = 0.95, .parallel = TRUE)"
"0","      "
"0","      for (val in sequence(5)) {"
"0","        corrMat <- myDGSA$sensitivityMatrix[val,,]"
"0","        corrMat[is.nan(corrMat)] = 0"
"0","        colnames(corrMat) = rownames(corrMat) <- myDGSA$parameters"
"0","        write.csv(corrMat,file.path(datadir,sprintf(""matrixDGSA_%s_%s_%d_%d.csv"",test_var,section_name,val,tim_ind)))"
"0","      }"
"0","      "
"0","      gg = plotMatrixDGSA(myDGSA, .hypothesis = FALSE , .method = ""circle"")"
"0","      write.csv(gg,file.path(datadir,sprintf(""matrixDGSA_%s_%s_%d.csv"",test_var,section_name,tim_ind)))"
"0","      saveRDS(myDGSA, file = file.path(datadir,sprintf(""myDGSA%s_%s_%d.rds"",test_var,section_name,tim_ind)))"
"0","    }"
"0","  }"
"0","}"
"1","Testing on conc, iterations 0_500, time ind 1

(key: 0-500=unconfined;501-1000=confined)
 "
"1","[1]"
"1"," ""Computing main effects..."""
"1","
"
"1","[1]"
"1"," ""Computing Interactions..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on head_.inlandsum...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on head_.inlandwint...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on CF_.glob...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on CF_.var...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on hk_.var...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on por_.mean...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on por_.var...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on vario_.type...."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  vario_.type.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  vario_.type.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  vario_.type.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  vario_.type.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  vario_.type.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on corr_.len...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on corr_.lenzx...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on corr_.lenyx...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on clay_.lyryn...."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  clay_.lyryn.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  clay_.lyryn.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  clay_.lyryn.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  clay_.lyryn.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  clay_.lyryn.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on vka..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on al..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on dmcoef..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on sy..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on ss..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on rech..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on rech_.farm...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on riv_.stg...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on riv_.cond...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on m..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on wel0..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on wel1..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on wel2..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on wel3..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on CF_.spatial...."""
"1","
"
"1","Testing on conc, iterations 0_500, time ind 2

(key: 0-500=unconfined;501-1000=confined)
 "
"1","[1]"
"1"," ""Computing main effects..."""
"1","
"
"1","[1]"
"1"," ""Computing Interactions..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on head_.inlandsum...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on head_.inlandwint...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on CF_.glob...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on CF_.var...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on hk_.var...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on por_.mean...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on por_.var...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on vario_.type...."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  vario_.type.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  vario_.type.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  vario_.type.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  vario_.type.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  vario_.type.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on corr_.len...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on corr_.lenzx...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on corr_.lenyx...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on clay_.lyryn...."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  clay_.lyryn.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  clay_.lyryn.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  clay_.lyryn.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  clay_.lyryn.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""        Computation failed due to inability to split  clay_.lyryn.  into 3 bins."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on vka..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on al..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on dmcoef..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on sy..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on ss..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on rech..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on rech_.farm...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on riv_.stg...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on riv_.cond...."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on m..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on wel0..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on wel1..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on wel2..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on wel3..."""
"1","
"
"1","[1]"
"1"," ""    Computing interactions conditioned on CF_.spatial...."""
"1","
"
